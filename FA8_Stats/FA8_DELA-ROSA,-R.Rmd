---
title: "FA8 DELA ROSA, R"
author: "Roland Dela Rosa"
date: "November 26, 2025"
output:
  md_document
subtitle: "**Github Link: https://github.com/rddelarosa/APM1111/blob/main/FA8_Stats/FA8_DELA-ROSA,-R?plain=1**"
---

```{r setup, include=FALSE}
library(dplyr)
library(car)
library(ggplot2)
library(rstatix)
library(knitr)
library(gghalves)

data("PlantGrowth")

```


# SECTION 1: INTRODUCTION

Introduction

This report performs a complete data analysis for the PlantGrowth dataset using a one-way ANOVA (1B).

Null Hypothesis ($H_0$): There is no significant difference on weight between treatment groups ($\mu_{ctrl} = \mu_{trt1} = \mu_{trt2}$).

Alternative Hypothesis ($H_a$): At least one group mean is different.

Dataset and Problem

The PlantGrowth dataset contains results from an experiment to compare yields (as measured by dried weight of plants) obtained under a control and two different treatment conditions.

Dependent Variable: weight (continuous)

Independent Variable: group (categorical: ctrl, trt1, trt2)

Checking of Assumptions

Assumption 1-3: Study Design

The dependent variable is continuous, the independent variable consists of categorical groups, and observations are independent.

Assumption 4: Outliers

We check for significant outliers using boxplots and the Interquartile Range (IQR) method.



```{r}
ggplot(PlantGrowth, aes(x = group, y = weight, fill = group)) +
  
  # 1. Half-Violin (Cloud) - nudged LEFT
  geom_half_violin(
    aes(fill = group),
    side = "r",
    trim = FALSE,
    alpha = 0.6,
    width = 0.8,
    position = position_nudge(x = 0.15)
  ) +
  
  # 2. Boxplot - nudged RIGHT
  geom_boxplot(
    width = 0.2,
    alpha = 0.5,
    outlier.shape = NA,
    position = position_nudge(x = -0.2),
    show.legend = FALSE
  ) +
  
  # 3. Jittered raw points (Rain) - centered
  geom_jitter(
    aes(color = group),
    width = 0.10,
    size = 1.8,
    alpha = 0.7
  ) +
  
  # 4. Styling
  theme_classic(base_size = 14) +
  labs(
    title = "Raincloud Plot: PlantGrowth Weight by Group",
    x = "Group",
    y = "Weight"
  ) +
  guides(fill = "none", color = "none") +
  
  # 5. Extra spacing so elements do not overlap or get cut
  scale_x_discrete(expand = expansion(mult = c(0.25, 0.25))) +
  coord_cartesian(clip = "off")
```


# Identify outliers mathematically
outliers <- PlantGrowth %>%
  group_by(group) %>%
  identify_outliers(weight)

# Print outliers table
if(nrow(outliers) > 0){
  kable(outliers, caption = "Detected Outliers")
} else {
  print("No extreme outliers were detected.")
}
```
Remark: Visual inspection of boxplots and statistical checks show no extreme outliers.

Assumption 5: Normality

We use the Shapiro-Wilk test to check if data is normally distributed for each group ($p > 0.05$).



```{r}
# Shapiro-Wilk test
shapiro_res <- PlantGrowth %>%
  group_by(group) %>%
  shapiro_test(weight)

kable(shapiro_res, caption = "Shapiro-Wilk Test for Normality")
```


Remark: The $p$-values for all groups are greater than 0.05. We assume the data is approximately normally distributed.


Assumption 6: Homogeneity of Variances

We use Levene's test to check if variances are equal across groups ($p > 0.05$).

```{r}
# Levene's Test
levene_res <- leveneTest(weight ~ group, data = PlantGrowth)
kable(levene_res, caption = "Levene's Test for Homogeneity of Variances")
```


Remark: The $p$-value is r round(levene_res$"Pr(>F)"[1], 3), which is > 0.05. Therefore, we assume homogeneity of variances.


Computation: One-Way ANOVA




```{r}
# Compute ANOVA
anova_model <- aov(weight ~ group, data = PlantGrowth)
anova_summary <- summary(anova_model)

# Show ANOVA Table
anova_summary
```
Descriptive Statistics

```{r}
# Calculate Mean and SD for reporting
desc_stats <- PlantGrowth %>%
  group_by(group) %>%
  get_summary_stats(weight, type = "mean_sd")

kable(desc_stats, caption = "Descriptive Statistics (Mean Â± SD)")
```
Post Hoc Comparisons (Tukey HSD)

Since the ANOVA result was significant ($p < 0.05$), we perform Tukey's HSD test to see which specific groups differ.

```{r}
tukey_res <- TukeyHSD(anova_model)
tukey_res

# Plotting the differences
plot(tukey_res)
```
Reporting (APA Style)

A one-way ANOVA was conducted to determine if there were significant differences in plant weight between three groups: ctrl ($n=10$), trt1 ($n=10$), and trt2 ($n=10$).

There were no outliers, as assessed by boxplot; data was normally distributed for each group, as assessed by the Shapiro-Wilk test ($p > .05$); and there was homogeneity of variances, as assessed by Levene's test ($p = .044$).

Data is presented as mean $\pm$ standard deviation. Plant weight was statistically significantly different between the different treatment groups, $F(2, 27) = 4.846, p = .016$.

Weight increased from the trt1 group ($M = 4.66, SD = 0.79$) to the ctrl group ($M = 5.03, SD = 0.58$) and the trt2 group ($M = 5.53, SD = 0.44$).

Tukey post hoc analysis revealed that the mean increase from trt1 to trt2 (0.87) was statistically significant ($p = .012$). However, the comparisons between ctrl vs trt1 ($p = .391$) and ctrl vs trt2 ($p = .198$) were not statistically significant.

Conclusion: We reject the null hypothesis. There is a significant difference in weight between the treatment groups, specifically between Treatment 1 and Treatment 2.






